"use strict";(self.webpackChunkbooks_reading_tracker=self.webpackChunkbooks_reading_tracker||[]).push([[259],{8259:function(e,n,t){t.r(n),t.d(n,{default:function(){return oe}});var i,l,s,a,o,r,d,c,u,h=t(9439),f=t(168),x=t(225),g=x.Z.div(i||(i=(0,f.Z)([""]))),j=t(2791),p=t(7892),b=t.n(p),Z=x.Z.div(l||(l=(0,f.Z)([""]))),m=x.Z.div(s||(s=(0,f.Z)([""]))),v=t(9836),k=t(3382),S=t(3994),C=t(9281),y=t(6890),D=t(5855),T=t(5527),Y=t(3153),L=t(3384),N=t(184),_=function(){var e=(0,Y.C)(L.UN);return(0,N.jsx)(m,{children:(0,N.jsx)(C.Z,{component:T.Z,children:(0,N.jsxs)(v.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,N.jsx)(y.Z,{children:(0,N.jsxs)(D.Z,{children:[(0,N.jsx)(S.Z,{align:"left",children:"Book title"}),(0,N.jsx)(S.Z,{align:"left",children:"Author"}),(0,N.jsx)(S.Z,{align:"left",children:"Year"}),(0,N.jsx)(S.Z,{align:"left",children:"Pages"})]})}),(0,N.jsx)(k.Z,{children:e.map((function(e){return(0,N.jsxs)(D.Z,{sx:{"&:last-of-type td, &:last-of-type th":{border:0}},children:[(0,N.jsxs)(S.Z,{align:"left",children:[e.pagesTotal===e.pagesFinished?"true":"false","' '",e.title]}),(0,N.jsx)(S.Z,{align:"left",children:e.author}),(0,N.jsx)(S.Z,{align:"left",children:e.publishYear}),(0,N.jsx)(S.Z,{align:"left",children:e.pagesTotal})]},e._id)}))})]})})})},F=x.Z.div(a||(a=(0,f.Z)([""]))),A=t(1474),B=function(){var e=(0,Y.T)(),n=(0,Y.C)(L.v3),t=(0,j.useState)(b()(n).diff(b()())),i=(0,h.Z)(t,2),l=i[0],s=i[1];return(0,j.useEffect)((function(){var t=setInterval((function(){b()(n).diff(b()())>=0?s(b()(n).diff(b()())):(s(0),e((0,L.lF)("fail")),clearInterval(t))}),1e3);return function(){clearInterval(t)}}),[]),(0,N.jsx)(F,{children:(0,N.jsxs)("dl",{children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("dt",{children:(0,A.lN)(l).d.toString().padStart(2,"0")}),(0,N.jsx)("dd",{children:"Days"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("dt",{children:(0,A.lN)(l).h.toString().padStart(2,"0")}),(0,N.jsx)("dd",{children:"Hrs"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("dt",{children:(0,A.lN)(l).m.toString().padStart(2,"0")}),(0,N.jsx)("dd",{children:"Minutes"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("dt",{children:(0,A.lN)(l).s.toString().padStart(2,"0")}),(0,N.jsx)("dd",{children:"Seconds"})]})]})})},M=function(){return(0,N.jsxs)(Z,{children:[(0,N.jsx)(B,{}),(0,N.jsx)(_,{})]})},E=x.Z.div(o||(o=(0,f.Z)([""]))),O=function(e){var n=e.trainingBookList,t=e.planningStartDate,i=e.planningEndDate,l=(0,Y.C)(L.SL);console.log(n);var s=(0,Y.C)(L.Nh),a=(0,Y.C)(L.v3),o=(0,Y.C)(L.nL);return o&&(console.log("BOOKS COUNTER"),console.log((0,A.ss)(l.books))),(0,N.jsxs)(E,{children:[(0,N.jsx)("h2",{children:"My goals"}),(0,N.jsxs)("ul",{className:"goals-body",children:[(0,N.jsxs)("li",{className:"goal",children:[(0,N.jsx)("p",{children:o?l.books.length:n.length}),(0,N.jsx)("p",{children:"Amount of books"})]}),(0,N.jsxs)("li",{className:"goal",children:[(0,N.jsx)("p",{children:o?b()(a).diff(b()(s),"day"):b()(i).diff(t,"day")||0}),(0,N.jsx)("p",{children:"Amount of days"})]}),o&&(0,N.jsxs)("li",{className:"goal",children:[(0,N.jsx)("p",{children:l.books.length-(0,A.ss)(l.books)+1}),(0,N.jsx)("p",{children:"Books left"})]})]})]})},P=t(3433),w=x.Z.div(r||(r=(0,f.Z)([""]))),H=t(1754),I=t(1652),R=t(4750),U=t(5853),q=t(5984),V=t(4653),W=t(5705),z=t(6727),$=function(){var e=(0,Y.C)(L.SL),n=(0,Y.C)(L.o3),t=(0,Y.C)(L.$3),i=(0,Y.T)(),l=(0,j.useState)(0),s=(0,h.Z)(l,2),a=s[0],o=s[1],r=(0,A.pd)(e.books);(0,j.useEffect)((function(){"fulfilled"===n&&(r?o(r.pagesTotal-r.pagesFinished):(o(0),i((0,L.lF)("success"))))}),[r,n]);var d=z.Ry({pages:z.Rx().min(1,"Please enter a valid value").max(a,"You have only ".concat(a," pages left in this book")).required("This field is required")}),c=(0,W.TA)({initialValues:{pages:0},validationSchema:d,onSubmit:function(e){console.log(e),i((0,V.UU)(e)),c.resetForm()}}),u=function(e){var n=(0,P.Z)(Object.values(e));return n.length<=5?n:n.filter((function(e,n,t){return n+1>t.length-5}))}(t);return(0,N.jsxs)(w,{children:[(0,N.jsxs)("form",{onSubmit:c.handleSubmit,children:[(0,N.jsx)(I._,{dateAdapter:R.y,children:(0,N.jsx)(H.M,{label:"Date",defaultValue:b()(),disabled:!0})}),(0,N.jsx)(U.Z,{id:"outlined-basic",label:"Amount of pages",variant:"outlined",type:"number",name:"pages",value:c.values.pages,onChange:c.handleChange,helperText:c.touched.pages&&c.errors.pages}),(0,N.jsx)("button",{type:"submit",children:"Add result"})]}),(0,N.jsxs)("div",{className:"results-container",children:[(0,N.jsx)("h3",{children:"Statistics"}),"fulfilled"===n?u.map((function(e){return(0,N.jsxs)("li",{children:[(0,N.jsx)("p",{children:e.time}),(0,N.jsx)("p",{children:e.pagesCount})]},(0,q.x0)())})):null]})]})},J=t(1413),K=x.Z.form(d||(d=(0,f.Z)([""]))),G=x.Z.div(c||(c=(0,f.Z)([""]))),Q=function(e){var n=e.trainingList,t=e.removeFromTrainingListHandler;return(0,N.jsx)(G,{children:(0,N.jsx)(C.Z,{component:T.Z,children:(0,N.jsxs)(v.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,N.jsx)(y.Z,{children:(0,N.jsxs)(D.Z,{children:[(0,N.jsx)(S.Z,{align:"left",children:"Book title"}),(0,N.jsx)(S.Z,{align:"left",children:"Author"}),(0,N.jsx)(S.Z,{align:"left",children:"Year"}),(0,N.jsx)(S.Z,{align:"left",children:"Pages"})]})}),(0,N.jsx)(k.Z,{children:n.map((function(e){return(0,N.jsxs)(D.Z,{sx:{"&:last-of-type td, &:last-of-type th":{border:0}},children:[(0,N.jsx)(S.Z,{align:"left",children:e.title}),(0,N.jsx)(S.Z,{align:"left",children:e.author}),(0,N.jsx)(S.Z,{align:"left",children:e.publishYear}),(0,N.jsx)(S.Z,{align:"left",children:e.pagesTotal}),(0,N.jsx)(S.Z,{align:"left",children:(0,N.jsx)("button",{type:"button",onClick:function(){console.log(e),t(e._id)},children:"D"})})]},e._id)}))})]})})})},X=t(5770),ee=t(4452),ne=function(e){var n=e.trainingBookList,t=e.startDate,i=e.endDate,l=e.updateTrainingBookList,s=e.updateStartDate,a=e.updateEndDate,o=e.updateIsFormSubmitted;console.log(n);var r=(0,Y.T)(),d=(0,j.useState)(null),c=(0,h.Z)(d,2),u=c[0],f=c[1],x=(0,Y.C)(ee.r9),g=(0,Y.C)(ee.k3),p=[].concat((0,P.Z)(x.map((function(e){return(0,J.Z)((0,J.Z)({},e),{},{label:e.title})}))),(0,P.Z)(g.map((function(e){return(0,J.Z)((0,J.Z)({},e),{},{label:e.title})}))));return(0,N.jsxs)(K,{onSubmit:function(e){e.preventDefault();var l={startDate:t,endDate:i,books:n.map((function(e){return e._id}))};r((0,V.fF)(l)),o(!0),console.log(l)},children:[(0,N.jsx)("h2",{children:"My training"}),(0,N.jsxs)("div",{className:"date-input-container",children:[(0,N.jsx)(I._,{dateAdapter:R.y,children:(0,N.jsx)(H.M,{label:"Start",defaultValue:b()(b()().format("YYYY-MM-DD")),onChange:function(e){e&&s(e.format("YYYY-MM-DD"))},disabled:!0})}),(0,N.jsx)(I._,{dateAdapter:R.y,children:(0,N.jsx)(H.M,{label:"Finish",onChange:function(e){e&&a(e.format("YYYY-MM-DD"))},disablePast:!0,minDate:b()().add(1,"day")})})]}),(0,N.jsxs)("div",{className:"books-input-container",children:[(0,N.jsx)(X.Z,{onChange:function(e,n){n&&(console.log(n),f(n))},value:u,disablePortal:!0,isOptionEqualToValue:function(e,n){return e._id===n._id},id:"combo-box-demo",options:p,sx:{width:300},renderInput:function(e){return(0,N.jsx)(U.Z,(0,J.Z)((0,J.Z)({},e),{},{label:"Choose books from the library "}))}}),(0,N.jsx)("button",{type:"button",onClick:function(){u&&(!function(e){if(console.log("addToTrainingBookListHandler"),e&&!n.find((function(n){return n._id===e._id}))){var t=e.title,i=e.author,s=e.publishYear,a=e.pagesTotal,o=e._id,r=e.pagesFinished;l([].concat((0,P.Z)(n),[{title:t,author:i,publishYear:s,pagesTotal:a,_id:o,pagesFinished:r}]))}}(u),f(null))},children:"Add"}),(0,N.jsx)("button",{type:"submit",children:"Start training"})]}),(0,N.jsx)(Q,{trainingList:n,removeFromTrainingListHandler:function(e){l(n.filter((function(n){return n._id!==e})))}})]})},te=x.Z.div(u||(u=(0,f.Z)([""]))),ie=t(4164),le=t(7689),se=document.querySelector("#modal-root"),ae=function(e){var n=e.modalType,t=e.modalCloseHandler,i=e.resetTrainingRegistrationData,l=(0,le.s0)(),s=(0,Y.T)();switch(n){case"success":return(0,ie.createPortal)((0,N.jsxs)(te,{children:[(0,N.jsx)("p",{children:"Congratulations! You made it in time!"}),(0,N.jsx)("button",{type:"button",onClick:function(){t(),i(),s((0,L.rF)())},children:"New training"}),(0,N.jsx)("button",{type:"button",onClick:function(){t(),l("/"),s((0,L.rF)())},children:"Back"})]}),se);case"fail":return(0,ie.createPortal)((0,N.jsxs)(te,{children:[(0,N.jsx)("p",{children:"Well done! but you need to be a little bit faster. You can do it)"}),(0,N.jsx)("button",{type:"button",onClick:function(){t(),i(),s((0,L.rF)())},children:"New training"}),(0,N.jsx)("button",{type:"button",onClick:function(){t(),l("/"),s((0,L.rF)())},children:"Back"})]}),se);case"book read":return(0,ie.createPortal)((0,N.jsxs)(te,{children:[(0,N.jsx)("p",{children:"Congratulations! Another book read."}),(0,N.jsx)("button",{type:"button",onClick:function(){t()},children:"Done"})]}),se)}},oe=function(){var e=(0,Y.C)(L.$3),n=(0,Y.C)(L.o3),t=(0,Y.C)(L.nL),i=(0,Y.C)(L.Yz),l=(0,Y.C)(L.UN),s=(0,Y.C)(L.d9);console.log("currentBookNumber"),console.log(s);var a=(0,Y.C)(ee.bH),o=[],r=function(){return b()().format("YYYY-MM-DD")},d=(0,j.useState)(o),c=(0,h.Z)(d,2),u=c[0],f=c[1],x=(0,j.useState)(r()),p=(0,h.Z)(x,2),Z=p[0],m=p[1],v=(0,j.useState)(""),k=(0,h.Z)(v,2),S=k[0],C=k[1],y=(0,j.useState)(!1),D=(0,h.Z)(y,2),T=D[0],_=D[1],F=(0,j.useState)(""),B=(0,h.Z)(F,2),E=B[0],P=B[1],w=(0,j.useState)(!1),H=(0,h.Z)(w,2),I=H[0],R=H[1],U=(0,j.useState)(!1),q=(0,h.Z)(U,2),W=q[0],z=q[1],J=function(e){R(e)};console.log("planningStatus"),console.log(i);var K=(0,Y.T)();(0,j.useEffect)((function(){a&&(K((0,V.uz)()),console.log("something"))}),[a]),(0,j.useEffect)((function(){switch(i){case"none":W||z(!0);break;case"active":W||z(!0),I&&K((0,ee.cJ)(l));break;case"success":P("success"),_(!0);break;case"fail":P("fail"),_(!0)}}),[i]),(0,j.useEffect)((function(){"active"===i&&s&&1!==s&&W&&(console.log("updateBookToRead"),console.log(s),K((0,ee.Ai)(l[s-2])),console.log("MODAL"),P("book read"),_(!0))}),[s]);var G=function(e){f(e)},Q=function(e){m(e)},X=function(e){C(e)};return console.log("STATS!"),"fulfilled"===n&&console.log(Object.values((0,A.Ln)(Object.values(e))).map((function(e,n,t){return(338-(0,A.dD)(t,n))/(10-n)}))),(0,N.jsxs)(g,{children:["active"===i||"success"===i||"fail"===i?(0,N.jsx)(M,{}):"none"===i?(0,N.jsx)(ne,{trainingBookList:u,startDate:Z,endDate:S,updateTrainingBookList:G,updateStartDate:Q,updateEndDate:X,updateIsFormSubmitted:J}):(0,N.jsx)("div",{children:"Loading..."}),(0,N.jsx)(O,{trainingBookList:u,planningStartDate:Z,planningEndDate:S}),t&&(0,N.jsx)($,{}),T&&(0,N.jsx)(ae,{modalType:E,modalCloseHandler:function(){_(!1)},resetTrainingRegistrationData:function(){m(r()),C(""),f(o)}})]})}}}]);
//# sourceMappingURL=259.1e28bb1d.chunk.js.map